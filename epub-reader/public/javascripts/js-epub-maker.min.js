!function e(n,t,i){function r(a,s){if(!t[a]){if(!n[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=t[a]={exports:{}};n[a][0].call(u.exports,(function(e){var t=n[a][1][e];return r(t||e)}),u,u.exports,e,n,t,i)}return t[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,n,t){!function(){e("./js/util/slugify");e("./js/util/handlebar-helpers");var i={"idpf-wasteland":e("../src/js/template-builders/idpf-wasteland-builder.js").builder,lightnovel:e("../src/js/template-builders/lightnovel-builder.js").builder},r=function(){var e=this,n={toc:[],landmarks:[],sections:[],stylesheet:{},additionalFiles:[],options:{}};this.withUuid=function(t){return n.uuid=t,e},this.withTemplate=function(t){return n.templateName=t,e},this.withTitle=function(t){return n.title=t,n.slug="untitled",e},this.withLanguage=function(t){return n.lang=t,e},this.withAuthor=function(t){return n.author=t,e},this.withPublisher=function(t){return n.publisher=t,e},this.withModificationDate=function(t){return n.modificationDate=t.toISOString(),n.modificationDateYMD=n.modificationDate.substr(0,10),e},this.withRights=function(t){return n.rights=t,e},this.withCover=function(t,i){return n.coverUrl=t,n.coverRights=i,e},this.withAttributionUrl=function(t){return n.attributionUrl=t,e},this.withStylesheetUrl=function(t,i){return n.stylesheet={url:t,styles:"",replaceOriginal:i},e},this.withSection=function(t){return n.sections.push(t),Array.prototype.push.apply(n.toc,t.collectToc()),Array.prototype.push.apply(n.landmarks,t.collectLandmarks()),e},this.withAdditionalFile=function(t,i,r){return n.additionalFiles.push({url:t,folder:i,filename:r}),e},this.withOption=function(t,i){return n.options[t]=i,e},this.makeEpub=function(){return n.publicationDate=(new Date).toISOString(),n.publicationDateYMD=n.publicationDate.substr(0,10),new Promise(((e,t)=>{i[n.templateName].make(n).then((function(n){fflate.zip(n,{level:0},((n,t)=>{const i=new Blob([t],{type:"application/octet-stream"});e(i)}))}))}))},this.downloadEpub=function(t,i){e.makeEpub().then((function(e){var r;r=i?n.title+".epub":n.slug+".epub",t&&"function"==typeof t&&t(e,r),saveAs(e,r)}))}};if(r.epubtypes=e("../src/js/epub-types.js"),r.Section=function(e,n,t,i,r){var o=this;function a(e,n){for(var t=e[n]?[e]:[],i=0;i<e.subSections.length;i++)Array.prototype.push.apply(t,a(e.subSections[i],n));return t}this.epubType=e,this.id=n,this.content=t,this.includeInToc=i,this.includeInLandmarks=r,this.subSections=[],t&&(t.renderTitle=!1!==t.renderTitle),this.withSubSection=function(e){return o.subSections.push(e),o},this.collectToc=function(){return a(this,"includeInToc")},this.collectLandmarks=function(){return a(this,"includeInLandmarks")}},void 0!==n)n.exports.EpubMaker=r;else if(void 0!==t)t.EpubMaker=r;else if("undefined"==typeof window)throw new Error("unable to expose EpubMaker: no module, exports object and no global window detected");"undefined"!=typeof window&&(window.EpubMaker=r)}()},{"../src/js/epub-types.js":4,"../src/js/template-builders/idpf-wasteland-builder.js":5,"../src/js/template-builders/lightnovel-builder.js":6,"./js/util/console":8,"./js/util/handlebar-helpers":9,"./js/util/slugify":10}],2:[function(e,n,t){var i,r,o=n.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(n){try{return i.call(null,e,0)}catch(n){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var l,u=[],f=!1,p=-1;function d(){f&&l&&(f=!1,l.length?u=l.concat(u):p=-1,u.length&&h())}function h(){if(!f){var e=c(d);f=!0;for(var n=u.length;n;){for(l=u,u=[];++p<n;)l&&l[p].run();p=-1,n=u.length}l=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(n){try{return r.call(null,e)}catch(n){return r.call(this,e)}}}(e)}}function m(e,n){this.fun=e,this.array=n}function g(){}o.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];u.push(new m(e,n)),1!==u.length||f||c(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],3:[function(e,n,t){(function(e){!function(t){var i,r=function(e){return"function"==typeof e},o=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},a=function(e){return!1===e||e===t||null===e},s=function(e,n){return[].slice.call(e,n)},c="undefined",l=typeof TypeError===c?Error:TypeError;if(typeof e!==c&&e.nextTick)i=e.nextTick;else if(typeof MessageChannel!==c){var u=new MessageChannel,f=[];u.port1.onmessage=function(){f.length&&f.shift()()},i=function(e){f.push(e),u.port2.postMessage(0)}}else i=function(e){setTimeout(e,0)};function p(e){i((function(){throw e}))}function d(e){return this.then(e,t)}function h(e){return this.then(t,e)}function m(e,n){return this.then((function(n){return r(e)?e.apply(null,o(n)?n:[n]):b.onlyFuncs?n:e}),n||t)}function g(e){function n(){e()}return this.then(n,n),this}function y(e){return this.then((function(n){return r(e)?e.apply(null,o(n)?n.splice(0,0,void 0)&&n:[void 0,n]):b.onlyFuncs?n:e}),(function(n){return e(n)}))}function v(e){return this.then(t,e?function(n){throw e(n),n}:p)}var b=function(e){var n,o=(t!==e?e:b.alwaysAsync)?i:function(e){e()},s=0,c=[],u={then:function(e,n){var t=b();return c.push([function(n){try{a(e)?t.resolve(n):t.resolve(r(e)?e(n):b.onlyFuncs?n:e)}catch(e){t.reject(e)}},function(e){if((a(n)||!r(n)&&b.onlyFuncs)&&t.reject(e),n)try{t.resolve(r(n)?n(e):n)}catch(e){t.reject(e)}}]),0!==s&&o(f),t.promise},success:d,error:h,otherwise:h,apply:m,spread:m,ensure:g,nodify:y,rethrow:v,isPending:function(){return 0===s},getStatus:function(){return s}};function f(){if(0!==s){var e,t=c,i=0,r=t.length,o=~s?0:1;for(c=[];i<r;i++)(e=t[i][o])&&e(n)}}function p(e){var t,i=!1;function a(e){return function(n){return i?void 0:(i=!0,e(n))}}if(s)return this;try{var c=!(!(t=e)||!(typeof t).match(/function|object/))&&e.then;if(r(c)){if(e===u)throw new l("Promise can't resolve itself");return c.call(e,a(p),a(w)),this}}catch(e){return a(w)(e),this}return o((function(){n=e,s=1,f()})),this}function w(e){return s||o((function(){try{throw e}catch(e){n=e}s=-1,f()})),this}return u.toSource=u.toString=u.valueOf=function(){return n===t?this:n},{promise:u,resolve:p,fulfill:p,reject:w}};function w(e,n){var t=s(e);if(1===t.length&&o(t[0])){if(!t[0].length)return b.fulfilled([]);t=t[0]}var i=[],r=b(),a=t.length;if(a)for(var c=function(e){t[e]=b.promisify(t[e]),t[e].then((function(o){i[e]=n?t[e]:o,--a||r.resolve(i)}),(function(o){n?(i[e]=t[e],--a||r.resolve(i)):r.reject(o)}))},l=0,u=a;l<u;l++)c(l);else r.resolve(i);return r.promise}function x(e,n){return e.then(r(n)?n:function(){return n})}if(b.deferred=b.defer=b,b.nextTick=i,b.alwaysAsync=!0,b.onlyFuncs=!0,b.resolved=b.fulfilled=function(e){return b(!0).resolve(e).promise},b.rejected=function(e){return b(!0).reject(e).promise},b.wait=function(e){var n=b();return setTimeout(n.resolve,e||0),n.promise},b.delay=function(e,n){var t=b();return setTimeout((function(){try{t.resolve(r(e)?e.apply(null):e)}catch(e){t.reject(e)}}),n||0),t.promise},b.promisify=function(e){return e&&r(e.then)?e:b.resolved(e)},b.all=function(){return w(arguments,!1)},b.resolveAll=function(){return w(arguments,!0)},b.sequence=function(){return function(e){var n=s(e);1===n.length&&o(n[0])&&(n=n[0]);for(var t=b(),i=0,r=n.length,a=b.resolved();i<r;i++)a=x(a,n[i]);return t.resolve(a),t.promise}(arguments)},b.nodeCapsule=function(e,n){return n||(n=e,e=void 0),function(){var t=b(),i=s(arguments);i.push((function(e,n){e?t.reject(e):t.resolve(arguments.length>2?s(arguments,1):n)}));try{n.apply(e,i)}catch(e){t.reject(e)}return t.promise}},"function"==typeof define&&define.amd)define("D.js",[],(function(){return b}));else if(typeof n!==c&&n.exports)n.exports=b;else if(typeof window!==c){var T=window.D;b.noConflict=function(){return window.D=T,b},window.D=b}}()}).call(this,e("_process"))},{_process:2}],4:[function(e,n,t){!function(){for(var e=[{name:"abstract",group:"Front Matter",description:"A short summary of the principle ideas, concepts and conclusions of the work, or of a section or except within it."},{name:"foreword",group:"Front Matter",description:"An introductory section that precedes the work, typically not written by the work's author."},{name:"preface",group:"Front Matter",description:"An introductory section that precedes the work, typically written by the work's author."},{name:"introduction",group:"Front Matter",description:"A section in the beginning of the work, typically introducing the reader to the scope or nature of the work's content."},{name:"preamble",group:"Front Matter",description:"A section in the beginning of the work, typically containing introductory and/or explanatory prose regarding the scope or nature of the work's content"},{name:"epigraph",group:"Front Matter",description:"A quotation that is pertinent but not integral to the text."},{name:"non-specific frontmatter",group:"Front Matter",description:"Content placed in the frontmatter section, but which has no specific semantic meaning."},{name:"part",group:"Body Matter",description:"An introductory section that sets the background to a story, typically part of the narrative."},{name:"chapter",group:"Body Matter",description:"An introductory section that sets the background to a story, typically part of the narrative."},{name:"prologue",group:"Body Matter",description:"An introductory section that sets the background to a story, typically part of the narrative."},{name:"conclusion",group:"Body Matter",description:"An ending section that typically wraps up the work."},{name:"epilogue",group:"Body Matter",description:"A concluding section that is typically written from a later point in time than the main story, although still part of the narrative."},{name:"afterword",group:"Back Matter",description:"A closing statement from the author or a person of importance to the story, typically providing insight into how the story came to be written, its significance or related events that have transpired since its timeline."},{name:"non-specific backmatter",group:"Back Matter",description:"Content placed in the backmatter section, but which has no specific semantic meaning."},{name:"rearnote",group:"Back Matter",description:"A note appearing in the rear (backmatter) of the work, or at the end of a section."}],t={},i=0;i<e.length;i++){var r=e[i].group;(t[r]||(t[r]=[])).push(e[i])}n.exports={types:e,groups:t,getGroup:function(e){return{abstract:"frontmatter",foreword:"frontmatter",preface:"frontmatter",introduction:"frontmatter",preamble:"frontmatter",epigraph:"frontmatter","non-specific frontmatter":"frontmatter",part:"bodymatter",chapter:"bodymatter",prologue:"bodymatter",conclusion:"bodymatter",epilogue:"bodymatter",afterword:"backmatter","non-specific backmatter":"backmatter",rearnote:"backmatter"}[e]}}}()},{}],5:[function(e,n,t){!function(){var i=e("d.js"),r=e("../../js/util/ajax"),o="application/epub+zip",a='<?xml version="1.0" encoding="UTF-8"?>\n<container xmlns="urn:oasis:names:tc:opendocument:xmlns:container" version="1.0">\n <rootfiles>\n       <rootfile full-path="EPUB/untitled.opf"     \n          media-type="application/oebps-package+xml"/>\n  </rootfiles>\n</container>',s='@charset "UTF-8";\n@namespace "http://www.w3.org/1999/xhtml";\n@namespace epub "http://www.idpf.org/2007/ops";\n\nbody {\n    margin-left: 6em;\n    margin-right: 2em;\n    color: black;\n    font-family: times, \'times new roman\', serif;\n    background-color: rgb(255,255,245);\n    line-height: 1.5em;\n}\n\nh2 {\n    margin-top: 5em;\n    margin-bottom: 2em;\n}\n\nh3 {\n    margin-top: 3em;\n}\n\n.linegroup {\n    margin-top: 1.6em;\n}\n\nspan.lnum {\n    float: right;\n    color: gray;\n    font-size : 90%;\n}\n\na.noteref {\n    color: rgb(215,215,195);\n    text-decoration: none;\n    margin-left: 0.5em;\n    margin-right: 0.5em;\n}\n\nsection#rearnotes a {\n    color: black;\n    text-decoration: none;\n    border-bottom : 1px dotted gray;\n    margin-right: 0.8em;\n}\n\n.indent {\n    padding-left: 3em;\n}\n\n.indent2 {\n    padding-left: 5em;\n}\n\n*[epub|type~=\'dedication\'] {\n    padding-left: 2em;\n}\n',c='{{!-- strange if-construction, but this is a workaround for gulp-js-html-inject, whose minifier wreaks havoc otherwise --}}\n{{#if epubType}}<section epub:type="{{epubType}}" id="{{id}}">{{else}}<section id="{{id}}">{{/if}}\n\n    {{#if content.renderTitle}}<h2>{{content.title}}</h2>{{/if}} \n    {{#if content.content}}{{{content.content}}}{{/if}}\n    \n    {{#each subSections}} {{> sectionTemplate}} {{/each}}\n    \n{{#if epubType}}</section>{{else}}</section>{{/if}}',l='<?xml version="1.0" encoding="UTF-8"?>\n<package xmlns="http://www.idpf.org/2007/opf" version="3.0" unique-identifier="uid" xml:lang="en-US" prefix="cc: http://creativecommons.org/ns#">\n    <metadata xmlns:dc="http://purl.org/dc/elements/1.1/">\n        <dc:identifier id="uid">{{uuid}}</dc:identifier>\n        <dc:title>{{title}}</dc:title>\n        <dc:creator>{{author}}</dc:creator>\n        <dc:language>{{lang}}</dc:language>\n        <dc:date>{{publicationDate}}</dc:date>\n        <meta property="dcterms:modified">{{modificationDate}}</meta>\n        {{#if rights}}\n            \x3c!-- rights expressions for the work as a whole --\x3e\n            {{#if rights.description}}<dc:rights>{{rights.description}}</dc:rights>{{/if}}\n            {{#if rights.license}}<link rel="cc:license" href="{{rights.license}}"/>{{/if}}\n            {{#if rights.attributionUrl}}<meta property="cc:attributionURL">{{attributionUrl}}</meta>{{/if}}\n        {{/if}}\n        {{#if coverUrl}}\n            {{#if coverRights}}\n                \x3c!-- rights expression for the cover image --\x3e       \n                {{#if coverRights.license}}<link rel="cc:license" refines="#cover" href="{{coverRights.license}}" />{{/if}}\n                {{#if coverRights.attributionUrl}}<link rel="cc:attributionURL" refines="#cover" href="{{coverRights.attributionUrl}}" />{{/if}}\n            {{/if}}\n                \x3c!-- cover meta element included for 2.0 reading system compatibility: --\x3e\n                <meta name="cover" content="cover"/>\n        {{/if}}\n    </metadata>\n    <manifest>\n        {{#each sections}}{{> sectionsOPFManifestTemplate}}{{/each}}\n        <item id="nav" href="untitled-nav.xhtml" properties="nav" media-type="application/xhtml+xml" />\n        {{#if coverUrl}}\n        <item id="cover" href="untitled-cover.{{extension coverUrl}}" media-type="{{mimetype coverUrl}}" properties="cover-image" />\n        {{/if}}\n        <item id="css" href="untitled.css" media-type="text/css" />\n        \x3c!-- ncx included for 2.0 reading system compatibility: --\x3e\n        <item id="ncx" href="untitled.ncx" media-type="application/x-dtbncx+xml" />\n    </manifest>\n    <spine toc="ncx">\n        {{#each sections}}{{> sectionsOPFSpineTemplate}}{{/each}}\n    </spine>    \n</package>\n',u='<?xml version="1.0" encoding="UTF-8"?>\n<ncx xmlns:ncx="http://www.daisy.org/z3986/2005/ncx/" xmlns="http://www.daisy.org/z3986/2005/ncx/"\n    version="2005-1" xml:lang="en">\n    <head>\n        <meta name="dtb:uid" content="{{uuid}}"/>\n    </head>\n    <docTitle>\n        <text>{{title}}</text>\n    </docTitle>\n    <navMap>\n        \x3c!-- 2.01 NCX: playOrder is optional --\x3e\n        {{#each sections}}{{> sectionsNCXTemplate}}{{/each}}\n    </navMap>\n</ncx>\n',f='<?xml version="1.0" encoding="UTF-8"?>\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"\n  xmlns:epub="http://www.idpf.org/2007/ops">\n    <head>\n        <meta charset="utf-8"></meta>       \n        <link rel="stylesheet" type="text/css" href="untitled.css" class="day" title="day"/> \n    </head>\n    <body>\n        <nav epub:type="toc" id="toc">\n            <ol>\n                {{#each sections}}{{> sectionsNavTemplate}}{{/each}}\n            </ol>           \n        </nav>\n        <nav epub:type="landmarks">\n            <ol>\n                {{#each landmarks}}\n                <li><a epub:type="{{epubType}}" href="{{../slug}}-content.xhtml#{{id}}">{{#if content.title}}{{content.title}}{{else}}{{epubType}}{{/if}}</a></li>\n                {{/each}}\n            </ol>\n        </nav>\n    </body>\n</html>\n',p='<?xml version="1.0" encoding="UTF-8"?>\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" xmlns:epub="http://www.idpf.org/2007/ops">\n   <head>\n        <meta charset="utf-8"></meta>\n        <title>{{content.title}}</title>\n        <link rel="stylesheet" type="text/css" href="../untitled.css" class="day" title="day"/> \n    </head>\n    <body>\n        {{#if content.renderTitle}}<h2>{{content.title}}</h2>{{/if}} \n        {{#if content.content}}{{{content.content}}}{{/if}}\n    </body>\n</html>\n',d='\n<item id="{{id}}" href="text/{{id}}-content.xhtml" media-type="application/xhtml+xml" />\n{{#each subSections}}{{> sectionsOPFManifestTemplate}}{{/each}}\n',h='<itemref idref="{{id}}" />\n{{#each subSections}}{{> sectionsOPFSpineTemplate}}{{/each}}\n',m='\n<navPoint id="{{id}}">\n    <navLabel>\n        <text>{{content.title}}</text>\n    </navLabel>\n    <content src="text/{{id}}-content.xhtml"/>\n    {{#each subSections}} {{> sectionsNCXTemplate}} {{/each}}\n</navPoint>\n',g='\n<li>\n    <a href="text/{{id}}-content.xhtml">{{content.title}}</a>\n    {{#if subSections}}\n    <ol>\n        {{#each subSections}}{{> sectionsNavTemplate}}{{/each}}\n    </ol>\n    {{/if}}\n</li>\n',y=function(){function e(t,i){t.EPUB["text/"+i.id+"-content.xhtml"]=fflate.strToU8(n(p,i));for(var r=0;r<i.subSections.length;r++)e(t,i.subSections[r])}function n(e,n,t){return i=Handlebars.compile(e)(n),t||"undefined"==typeof html_beautify?i:html_beautify(i,{end_with_newline:!1,indent_char:"\t",indent_inner_html:!0,indent_size:"1",preserve_newlines:!1,wrap_line_length:"0",unformatted:[],selector_separator_newline:!1,newline_between_rules:!0});var i}this.make=function(t){var p={"META-INF":{},EPUB:{}},y=i();return i.all(function(e){e.mimetype=fflate.strToU8(o)}(p),function(e,t){e["META-INF"]["container.xml"]=fflate.strToU8(n(a,t))}(p,t),function(e,t){Handlebars.registerPartial("sectionsOPFManifestTemplate",d),Handlebars.registerPartial("sectionsOPFSpineTemplate",h),e.EPUB[t.slug+".opf"]=fflate.strToU8(n(l,t))}(p,t),function(e,n){var t=i();return t.resolve(!0),t.promise}(),function(e,t){Handlebars.registerPartial("sectionsNCXTemplate",m),e.EPUB[t.slug+".ncx"]=fflate.strToU8(n(u,t))}(p,t),function(e,t){Handlebars.registerPartial("sectionsNavTemplate",g),e.EPUB[t.slug+"-nav.xhtml"]=fflate.strToU8(n(f,t))}(p,t),function(e,t){var o=i();if(t.stylesheet.url)return r(t.stylesheet.url).then((function(e){t.styles=e.data,a()}));a();return o.promise;function a(){var i={original:t.stylesheet.replaceOriginal?"":s,custom:t.styles};e.EPUB[t.slug+".css"]=fflate.strToU8(n("{{{original}}}{{{custom}}}",i,!0)),o.resolve(!0)}}(p,t),function(n,t){Handlebars.registerPartial("sectionTemplate",c);for(var i=0;i<t.sections.length;i++)e(n,t.sections[i])}(p,t)).then((function(){y.resolve(p)})),y.promise}};if(void 0!==n)n.exports.builder=new y;else if(void 0!==t)t.builder=new y;else if("undefined"==typeof window)throw new Error("unable to expose module: no module, exports object and no global window detected");"undefined"!=typeof window&&(window.epubMaker=new y)}()},{"../../js/util/ajax":7,"../../js/util/console":8,"d.js":3}],6:[function(e,n,t){!function(){var i=e("d.js"),r=e("../../js/util/ajax"),o="application/epub+zip",a='<?xml version="1.0" encoding="UTF-8"?>\n<container xmlns="urn:oasis:names:tc:opendocument:xmlns:container" version="1.0">\n\t<rootfiles>\n\t\t<rootfile full-path="EPUB/lightnovel.opf"\n\t\t\tmedia-type="application/oebps-package+xml"/>\n\t</rootfiles>\n</container>',s='<?xml version="1.0" encoding="UTF-8"?>\n<package xmlns="http://www.idpf.org/2007/opf" version="3.0" unique-identifier="uid" xml:lang="en-US" prefix="cc: http://creativecommons.org/ns#">\n    <metadata xmlns:dc="http://purl.org/dc/elements/1.1/">\n        <dc:identifier id="uid">{{uuid}}</dc:identifier>\n        <dc:title>{{title}}</dc:title>\n        <dc:creator>{{author}}</dc:creator>\n        <dc:language>{{lang}}</dc:language>\n        <dc:date>{{publicationDate}}</dc:date>\n        <meta property="dcterms:modified">{{modificationDate}}</meta>\n        {{#if rights}}\n            \x3c!-- rights expressions for the work as a whole --\x3e\n            {{#if rights.description}}<dc:rights>{{rights.description}}</dc:rights>{{/if}}\n            {{#if rights.license}}<link rel="cc:license" href="{{rights.license}}"/>{{/if}}\n            {{#if rights.attributionUrl}}<meta property="cc:attributionURL">{{attributionUrl}}</meta>{{/if}}\n        {{/if}}\n        {{#if coverUrl}}\n            {{#if coverRights}}\n                \x3c!-- rights expression for the cover image --\x3e       \n                {{#if coverRights.license}}<link rel="cc:license" refines="#cover" href="{{coverRights.license}}" />{{/if}}\n                {{#if coverRights.attributionUrl}}<link rel="cc:attributionURL" refines="#cover" href="{{coverRights.attributionUrl}}" />{{/if}}\n            {{/if}}\n                \x3c!-- cover meta element included for 2.0 reading system compatibility: --\x3e\n                <meta name="cover" content="cover"/>\n        {{/if}}\n    </metadata>\n    <manifest>\n        {{#each sections}}{{> sectionsOPFManifestTemplate}}{{/each}}\n        <item id="nav" href="nav.html" properties="nav" media-type="application/xhtml+xml" />\n        {{#each additionalFiles}}\n        <item id="{{filename}}" href="{{folder}}/{{filename}}" media-type="{{mimetype filename}}" />\n        {{/each}}\n        {{#if coverUrl}}\n        <item id="cover" href="images/{{options.coverFilename}}" media-type="{{mimetype options.coverFilename}}" properties="cover-image" />\n        {{/if}}\n        <item id="css" href="css/main.css" media-type="text/css" />\n        \x3c!-- ncx included for 2.0 reading system compatibility: --\x3e\n        <item id="ncx" href="lightnovel.ncx" media-type="application/x-dtbncx+xml" />\n    </manifest>\n    <spine toc="ncx">\n        <itemref idref="nav" />\n        {{#each sections}}{{> sectionsOPFSpineTemplate}}{{/each}}\n    </spine>\n    <guide>\n        <reference type="toc" href="nav.html"/>\n    </guide>\n</package>\n',c='<?xml version="1.0" encoding="UTF-8"?>\n<ncx xmlns:ncx="http://www.daisy.org/z3986/2005/ncx/" xmlns="http://www.daisy.org/z3986/2005/ncx/"\n    version="2005-1" xml:lang="en">\n    <head>\n        <meta name="dtb:uid" content="{{uuid}}"/>\n    </head>\n    <docTitle>\n        <text>{{title}}</text>\n    </docTitle>\n    <docAuthor>\n        <text>{{author}}</text>\n    </docAuthor>\n    <navMap>\n        \x3c!-- 2.01 NCX: playOrder is optional --\x3e\n        {{#each sections}}{{> sectionsNCXTemplate}}{{/each}}\n    </navMap>\n</ncx>\n',l='<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset="utf-8">\n        <title>{{options.tocName}}</title>\n        <link rel="stylesheet" type="text/css" href="css/main.css"> \n    </head>\n    <body>\n        <div class="cover divimage">\n            <img src="images/{{options.coverFilename}}" alt="Cover" />\n        </div>\n        <div class="center">\n            <h1>{{title}}</h1>\n            <div>{{author}}</div>\n            <div>{{publisher}}</div>\n            <div>{{modificationDateYMD}}</div>\n        </div>\n\n        <nav epub:type="toc" id="toc">\n            <ol>\n                {{#each sections}}{{> sectionsNavTemplate}}{{/each}}\n            </ol>\n        </nav>\n        <nav class="hidden" epub:type="landmarks">\n            <ol>\n                <li><a epub:type="toc" href="#toc">{{options.tocName}}</a></li>\n            </ol>\n        </nav>\n    </body>\n</html>\n',u='@charset "UTF-8";\n@namespace "http://www.w3.org/1999/xhtml";\n@namespace epub "http://www.idpf.org/2007/ops";\n\nbody {\n    padding: 0%;\n    margin-top: 0%;\n    margin-bottom: 0%;\n    margin-left: 1%;\n    margin-right: 1%;\n    line-height: 130%;\n    text-align: justify;\n    background-color: rgb(255, 255, 245);\n}\n\ndiv {\n    margin: 0px;\n    padding: 0px;\n    line-height: 130%;\n    text-align: justify;\n}\n\np {\n    text-align: justify;\n    text-indent: 2em;\n    line-height: 130%;\n    margin-bottom: -0.8em;\n}\n\n.divimage {\n    page-break-after: always;\n}\n\n.cover {\n    width: 100%;\n    padding: 0px;\n}\n\n.center {\n    text-align: center;\n    margin-left: 0%;\n    margin-right: 0%;\n}\n\n.left {\n    text-align: center;\n    margin-left: 0%;\n    margin-right: 0%;\n}\n\n.right {\n    text-align: right;\n    margin-left: 0%;\n    margin-right: 0%;\n}\n\n.quote {\n    margin-top: 0%;\n    margin-bottom: 0%;\n    margin-left: 1em;\n    margin-right: 1em;\n    text-align: justify;\n}\n\n.hidden {\n    display: none;\n}\n\nh1 {\n    line-height: 130%;\n    text-align: center;\n    font-weight: bold;\n    font-size: xx-large;\n}\n\nh2 {\n    line-height: 130%;\n    text-align: center;\n    font-weight: bold;\n    font-size: x-large;\n}\n\nh3 {\n    line-height: 130%;\n    text-align: center;\n    font-weight: bold;\n    font-size: large;\n}\n\nh4 {\n    line-height: 130%;\n    text-align: center;\n    font-weight: bold;\n    font-size: medium;\n}\n\nh5 {\n    line-height: 130%;\n    text-align: center;\n    font-weight: bold;\n    font-size: small;\n}\n\nh6 {\n    line-height: 130%;\n    text-align: center;\n    font-weight: bold;\n    font-size: x-small;\n}\n',f='<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset="utf-8">\n        <title>{{content.fullTitle}}</title>\n        <link rel="stylesheet" type="text/css" href="css/main.css"> \n    </head>\n    <body>\n        {{#if content.renderTitle}}<h2>{{content.title}}</h2>{{/if}} \n        {{#if content.content}}{{{content.content}}}{{/if}}\n    </body>\n</html>\n',p='<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset="utf-8">\n        <title>{{content.fullTitle}}</title>\n        <link rel="stylesheet" type="text/css" href="css/main.css"> \n    </head>\n    <body>\n        {{#if content.renderTitle}}<h2>{{content.title}}</h2>{{/if}}\n        {{#if subSections}}\n        <ol>\n            {{#each subSections}}{{> sectionsNavTemplate}}{{/each}}\n        </ol>\n        {{/if}}\n    </body>\n</html>\n',d='\n<li>\n    {{#if needPage}}\n    <a href="{{name}}.html">{{content.title}}</a>\n    {{/if}}\n    {{#if subSections}}\n    <ol>\n        {{#each subSections}}{{> sectionsNavTemplate}}{{/each}}\n    </ol>\n    {{/if}}\n</li>\n',h='\n<navPoint id="{{name}}">\n    <navLabel>\n        <text>{{content.title}}</text>\n    </navLabel>\n    {{#if needPage}}\n    <content src="{{name}}.html"/>\n    {{/if}}\n    {{#each subSections}} {{> sectionsNCXTemplate}} {{/each}}\n</navPoint>\n',m='{{#if needPage}}\n<item id="{{name}}" href="{{name}}.html" media-type="application/xhtml+xml" />\n{{/if}}\n{{#each subSections}}{{> sectionsOPFManifestTemplate}}{{/each}}\n',g='<itemref idref="{{name}}" />\n{{#each subSections}}{{> sectionsOPFSpineTemplate}}{{/each}}\n',y=function(){function e(n,t,i){n.content||(n.content={}),t?(t=n.content.fullTitle=t+" - "+n.content.title,i=n.name=i+"-"+n.rank):(t=n.content.fullTitle=n.content.title,i=n.name=""+n.rank),(n.content.content||n.content.renderTitle||"auto-toc"==n.epubType)&&(n.needPage=!0);for(var r=0;r<n.subSections.length;r++)n.subSections[r].rank=r,e(n.subSections[r],t,i)}function n(e,i){i.needPage&&("auto-toc"==i.epubType?e.EPUB[i.name+".html"]=fflate.strToU8(t(p,i)):e.EPUB[i.name+".html"]=fflate.strToU8(t(f,i)));for(var r=0;r<i.subSections.length;r++)n(e,i.subSections[r])}function t(e,n,t){return i=Handlebars.compile(e)(n),t||"undefined"==typeof html_beautify?i:html_beautify(i,{end_with_newline:!1,indent_char:"\t",indent_inner_html:!0,indent_size:"1",preserve_newlines:!1,wrap_line_length:"0",unformatted:[],selector_separator_newline:!1,newline_between_rules:!0});var i}this.make=function(f){var p={"META-INF":{},EPUB:{}};p.EPUB.images={},p.EPUB.css={};var y=i();return function(n){n.options.tocName=n.options.tocName||"Menu";for(var t=0;t<n.sections.length;t++)n.sections[t].rank=t,e(n.sections[t])}(f),i.all(function(e){e.mimetype=fflate.strToU8(o)}(p),function(e,n){e["META-INF"]["container.xml"]=fflate.strToU8(t(a,n))}(p,f),function(e,n){Handlebars.registerPartial("sectionsOPFManifestTemplate",m),Handlebars.registerPartial("sectionsOPFSpineTemplate",g),e.EPUB["lightnovel.opf"]=fflate.strToU8(t(s,n))}(p,f),function(e,n){var t=i();return t.resolve(!0),t.promise}(),function(e,n){for(var t=[],r=0;r<n.additionalFiles.length;r++){n.additionalFiles[r];var o=new i;o.resolve(""),t.push(o.promise)}return i.all(t)}(0,f),function(e,n){Handlebars.registerPartial("sectionsNCXTemplate",h),e.EPUB["lightnovel.ncx"]=fflate.strToU8(t(c,n))}(p,f),function(e,n){Handlebars.registerPartial("sectionsNavTemplate",d),e.EPUB["nav.html"]=fflate.strToU8(t(l,n))}(p,f),function(e,n){var o=i();if(n.stylesheet.url)return r(n.stylesheet.url).then((function(e){n.styles=e.data,a()}));a();return o.promise;function a(){var i={original:n.stylesheet.replaceOriginal?"":u,custom:n.styles};e.EPUB.css["main.css"]=fflate.strToU8(t("{{{original}}}{{{custom}}}",i,!0)),o.resolve(!0)}}(p,f),function(e,t){for(var i=0;i<t.sections.length;i++)n(e,t.sections[i])}(p,f)).then((function(){y.resolve(p)}),(function(e){console.log(e)})),y.promise}};if(void 0!==n)n.exports.builder=new y;else if(void 0!==t)t.builder=new y;else if("undefined"==typeof window)throw new Error("unable to expose module: no module, exports object and no global window detected");"undefined"!=typeof window&&(window.epubMaker=new y)}()},{"../../js/util/ajax":7,"../../js/util/console":8,"d.js":3}],7:[function(e,n,t){var i;i=e("d.js"),n.exports=function(e,n){var t=i();try{var r=new(XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");r.open(n?"POST":"GET",e,1),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){r.readyState>3&&t.resolve({data:r.responseText,xhr:r})},r.send(n)}catch(e){t.reject(e)}return t.promise}},{"../../js/util/console":8,"d.js":3}],8:[function(e,n,t){!function(){function e(){}n.exports=function(){return"undefined"!=typeof console?console:{log:e,info:e,debug:e,warn:e,error:e}}}()},{}],9:[function(e,n,t){!function(){var e={jpeg:"image/jpeg",jpg:"image/jpeg",bmp:"image/bmp",png:"image/png",svg:"image/svg+xml",gif:"image/gif"};function n(e){return e.substr(e.lastIndexOf(".")+1)}Handlebars.registerHelper("extension",(function(e){return n(e)})),Handlebars.registerHelper("mimetype",(function(t){return e[n(t)]}))}()},{}],10:[function(e,n,t){!function(){(n.exports="undefined"!=typeof s&&s.slugify?s.slugify:e,n.exports===e)&&("undefined"!=typeof console&&console.debug?console.debug:function(){}).call(console,"underscore.string not found, falling back on (very) simple slugify..");function e(e){return e.toLowerCase().replace(/\s\W/g,"-")}}()},{}]},{},[1]);