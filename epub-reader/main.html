<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <title>EPUB Reader</title>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js" integrity="sha512-xQBQYt9UcgblF6aCMrwU1NkVA7HCXaSN2oq0so80KO+y68M+n64FOcqgav4igHe6D5ObBLIf68DWv+gfBowczg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="public/javascripts/epub.js"></script>
  <script src="public/javascripts/reader.js"></script>
  <link rel="stylesheet" type="text/css" href="public/stylesheets/epub.css">
</head>
<body>
  <div id="epub_input">
    <label id="input_label">Choose EPUB<input id="input" type="file" accept=".epub" hidden/></label>
    <label id="toolbar" style="display:none">TOC</label>
    <div id="mySidenav" class="sidenav" style="display:none">
      <ul id="tocs">
        <li class="grid-container">
          <div id="plus_btn" class="grid-item" style="font-size: 30px">&plus;</div>
          <div id="minus_btn" class="grid-item" style="font-size: 30px">&minus;</div>
        </li>
      </ul>
    </div>
  </div>
  <div id="viewer_out">
    <a id="prev_nav" class="navlink">...</a>
    <div id="viewer" class="scrolled"></div>
    <a id="next_nav" class="navlink">...</a>    
  </div>
  <div id="prev" class="arrow">‹</div>
  <div id="next" class="arrow">›</div>
  <div class="modal-content" id="hl">Highlight</div>
</body>
<script>
  var book = ePub();
  var rendition, filename;
  var font_size = 28;
  var inputElement = document.getElementById("input");

  inputElement.addEventListener('change', function (e) {
    var file = e.target.files[0];
    filename = file.name;
    if (window.FileReader) {
        var reader = new FileReader();
        reader.onload = openBook;
        reader.readAsArrayBuffer(file);
        document.title = filename;
        document.getElementById("input_label").remove()
    }
  });

  var toolbarElement = document.getElementById("toolbar");
  toolbarElement.addEventListener("click", function() {
    $('#mySidenav').toggle()
    this.classList.toggle("active");
  });

  let isMobile = window.matchMedia("only screen and (max-width: 760px)").matches;
  $(".grid-item").click(function(){
    switch($(this).attr("id")) {
      case "plus_btn":
        font_size += 1;
        break;
      case "minus_btn":
        font_size -= 1;
        break;
      }
    rendition.themes.fontSize(`${font_size}px`);
  })
</script>
</html>
